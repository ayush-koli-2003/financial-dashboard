<div class="main">
    <div class="date-container">
        <div>
            <app-date-picker [currDate]="currDate" (dateEvent)="selectDate($event)"></app-date-picker>
        </div>
    </div>

    <div class="dashboard-container">
        <!-- <div class="card-container">
            <div>
                <p-card *ngIf="isDataLoaded">
                    <ng-template #title>Total Expense</ng-template>
                    <p>{{totalExpense | currency:'INR'}}</p>

                </p-card>
                <p-skeleton *ngIf="!isDataLoaded" size="7rem" />
            </div>
            <div>
                <p-card *ngIf="isDataLoaded">
                    <ng-template #title>Total Income</ng-template>
                    <p>{{totalIncome | currency:'INR'}}</p>
                </p-card>
                <p-skeleton *ngIf="!isDataLoaded" size="7rem" />
            </div>
            <div>
                <p-card *ngIf="isDataLoaded">
                    <ng-template #title>Total Budget</ng-template>
                    <p>{{totalBudget | currency:'INR'}}</p>
                </p-card>
                <p-skeleton *ngIf="!isDataLoaded" size="7rem" />
            </div>
            <div>
                <p-card *ngIf="isDataLoaded">
                    <ng-template #title>Total Investment</ng-template>
                    <p>{{totalInvestment | currency:'INR'}}</p>
                </p-card>
                <p-skeleton *ngIf="!isDataLoaded" size="7rem" />
            </div>
        </div> -->

        <div class="surface-ground px-2 py-5 md:px-6 lg:px-8">
            <div class="grid">
                <div class="col-12 md:col-6 lg:col-3">
                    <div *ngIf="isDataLoaded" class="surface-card shadow-2 p-3 border-round">
                        <div class="flex justify-content-between mb-3">
                            <div>
                                <span class="block text-500 font-medium mb-3">Total Expense</span>
                                <div class="text-900 font-medium text-xl">{{totalExpense | currency:currency}}</div>
                            </div>
                            <div class="flex align-items-center justify-content-center bg-blue-100 border-round" style="width:2.5rem;height:2.5rem">
                                <i class="pi pi-receipt text-blue-500 text-xl"></i>
                            </div>
                        </div>
                        <!-- <span class="text-green-500 font-medium">24 new </span>
                        <span class="text-500">since last visit</span> -->
                    </div>
                    <p-skeleton *ngIf="!isDataLoaded" [style]="{'width':'100%', 'height':'100%'}"/>
                </div>
                <div class="col-12 md:col-6 lg:col-3">
                    <div *ngIf="isDataLoaded" class="surface-card shadow-2 p-3 border-round">
                        <div class="flex justify-content-between mb-3">
                            <div>
                                <span class="block text-500 font-medium mb-3">Total Income</span>
                                <div class="text-900 font-medium text-xl">{{totalIncome | currency:currency}}</div>
                            </div>
                            <div class="flex align-items-center justify-content-center bg-orange-100 border-round" style="width:2.5rem;height:2.5rem">
                                <i class="pi pi-money-bill text-orange-500 text-xl"></i>
                            </div>
                        </div>
                        <!-- <span class="text-green-500 font-medium">%52+ </span>
                        <span class="text-500">since last week</span> -->
                        
                    </div>
                    <p-skeleton *ngIf="!isDataLoaded" [style]="{'width':'100%', 'height':'100%'}"/>
                </div>
                <div class="col-12 md:col-6 lg:col-3">
                    <div *ngIf="isDataLoaded" class="surface-card shadow-2 p-3 border-round">
                        <div class="flex justify-content-between mb-3">
                            <div>
                                <span class="block text-500 font-medium mb-3">Total Budget</span>
                                <div class="text-900 font-medium text-xl">{{totalBudget | currency:currency}}</div>
                            </div>
                            <div class="flex align-items-center justify-content-center bg-cyan-100 border-round" style="width:2.5rem;height:2.5rem">
                                <i class="pi pi-wallet text-cyan-500 text-xl"></i>
                            </div>
                        </div>
                        <!-- <span class="text-green-500 font-medium">520  </span>
                        <span class="text-500">newly registered</span> -->
                    </div>
                    <p-skeleton *ngIf="!isDataLoaded" [style]="{'width':'100%', 'height':'100%'}"/>
                </div>
                <div class="col-12 md:col-6 lg:col-3">
                    <div *ngIf="isDataLoaded" class="surface-card shadow-2 p-3 border-round">
                        <div class="flex justify-content-between mb-3">
                            <div>
                                <span class="block text-500 font-medium mb-3">Total Investment</span>
                                <div class="text-900 font-medium text-xl">{{totalInvestment | currency:currency}}</div>
                            </div>
                            <div class="flex align-items-center justify-content-center bg-purple-100 border-round" style="width:2.5rem;height:2.5rem">
                                <i class="pi pi-credit-card text-purple-500 text-xl"></i>
                            </div>
                        </div>
                        <!-- <span class="text-green-500 font-medium">85 </span>
                        <span class="text-500">responded</span> -->
                    </div>
                    <p-skeleton *ngIf="!isDataLoaded" class="border-round"/>
                </div>
            </div>
        </div>
        
        <div class="display-container">
            <div class="transaction-table" style="width: 55%;">
                <!-- Create generic table component -->
                <div class="card">
                    <p-table [paginator]="true" [rows]="5" stripedRows [value]="transactions" [tableStyle]="{ 'min-width': '30rem' }">
                        <ng-template #caption>
                            <div class="flex items-center justify-between">
                                <span class="text-xl font-bold">Recent Tranasactions</span>
                            </div>
                        </ng-template>
                        <ng-template #header>
                            <tr>
                                <th>Date</th>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Category</th>
                                <th>Amount</th>
                            </tr>
                        </ng-template>
                        <ng-template #body let-transaction>
                            <tr *ngIf="isTransactionsLoaded">
                                <td>{{ transaction.date | date}}</td>
                                <td>{{ transaction.name }}</td>
                                <td>{{ transaction.type }}</td>
                                <td>{{ transaction.category }}</td>
                                <td>
                                    <p-tag [value]="transaction.type === 'Expense'? ('-'+transaction.amount):transaction.type==='Income'?('+'+transaction.amount):(transaction.amount)" [severity]="transaction.type ==='Expense'?'danger':transaction.type==='Income'?'success':'warn'" />
                                </td>
                            </tr>
                            <tr *ngIf="!isTransactionsLoaded">
                                <td><p-skeleton /></td>
                                <td><p-skeleton /></td>
                                <td><p-skeleton /></td>
                                <td><p-skeleton /></td>
                                <td><p-skeleton /></td>
                            </tr>
                        </ng-template>
                        <!-- <ng-template *ngIf="isTransactionsLoaded" #footer> In total there are {{ transactions ? transactions.length : 0 }} transactions. </ng-template> -->
                    </p-table>
                </div>
            </div>
            <div class="charts-container" style="width: 45%;">
                <div class="charts-with-option">
                    <div class="options">
                        <div>
                            <p-button icon="pi pi-arrow-up-right" (onClick)="navigateTo()" label="See more" variant="outlined" severity="info"></p-button>
                        </div>
                    </div>
                    <div>
                        <!-- <p-carousel *ngIf="isChartsLoaded; else loader" [value]="charts" [numVisible]="1" [numScroll]="1" [circular]="true" [autoplayInterval]="3500">
                            <ng-template pTemplate="item" let-chart>
                                <div style="width: 90%; margin-top: 5%; height: 20%;">
        
                                    <app-generic-chart 
                                        [data]="chart.data" 
                                        [chartType]="chart.chartType" 
                                        [legend]="true" 
                                        [labels]="chart.labels">
                                    </app-generic-chart>
                                </div>
        
        
                            </ng-template>
                        </p-carousel> -->
                        <app-carousel *ngIf="isChartsLoaded" [charts]="charts"></app-carousel>
                        <ng-template #loader>
                            <p-skeleton size="100%" />
                        </ng-template>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
