<p-dialog [header]="'Update profile'" [modal]="true" [(visible)]="isUpdateVisible" [style]="{ width: '25rem' }">
    <app-update-profile (closeEvent)="closeUpdate()" [currData]="userProfile"></app-update-profile>
</p-dialog>

<p-dialog [header]="'Change password'" [modal]="true" [(visible)]="isChangePasswordVisible" [style]="{ width: '25rem' }">
    <app-change-password (closeEvent)="closeChangePassword()"></app-change-password>
</p-dialog>
<div *ngIf="isProfileLoaded else loader" class="mb-4 flex items-center justify-center">
    <div class="profile-container">
        <div class="image-container">
            <div class="image">
                <p-avatar image="https://th.bing.com/th/id/OIP.4Q7-yMnrlnqwR4ORH7c06AHaHa?rs=1&pid=ImgDetMain" [style]="{width:'60%',height:'60%'}" size="xlarge" shape="circle" />
            </div>
        </div>
        <div>
            <p-tabs value="0">
                <p-tablist>
                    <p-tab value="0">Personal Details</p-tab>
                    <p-tab value="1">Preferences</p-tab>
                    <p-tab value="2">Settings</p-tab>
                </p-tablist>
                <p-tabpanels>
                    <p-tabpanel value="0">
                        <div class="profile-header">
                            <div>
                                <h3>Personal Details</h3>
                            </div>
                            <div>
                                <p-button label="Update" icon="pi pi-pencil" severity="info" (onClick)="openUpdate()" />
                            </div>
                        </div>
                        <div class="profile-details">
                            <div class="detail">
                                <span>First Name: </span>
                                <span>{{userProfile.firstname}}</span>
                            </div>
                            <div class="detail">
                                <span>Last Name: </span>
                                <span>{{userProfile.lastname}}</span>
                            </div>
                        </div>
                    </p-tabpanel>
                    <p-tabpanel value="1">
                        <div class="profile-header">
                            <div>
                                <h3>Account Preferences</h3>
                            </div>
                            <div>
                                <p-button label="Update" icon="pi pi-pencil" severity="info" (onClick)="openUpdate()" />
                            </div>
                        </div>
                        <div class="profile-details">
                            <div class="detail">
                                <span>Currency Preference: </span>
                                <span>{{userProfile.currencyPreference}}</span>
                            </div>
                            <div class="detail">
                                <span>Notification Preference: </span>
                                <span>{{userProfile.notificationPreference === true? 'ON':'OFF'}}</span>
                            </div>
                        </div>
                    </p-tabpanel>
                    <p-tabpanel value="2">
                        <div class="profile-header">
                            <div>
                                <h3>User Settings</h3>
                            </div>
                            <div class="change-container">
                                <div>
                                    <p-button label="Change Password" icon="pi pi-pencil" severity="warn" (onClick)="openChangePassword()" />
                                </div>
                                <!-- <div>
                                    <p-button label="Change Email" icon="pi pi-pencil" severity="warn" (onClick)="openUpdate()" />
                                </div> -->
                            </div>

                        </div>
                        <div class="profile-details">
                            <div class="detail">
                                <span>Email: </span>
                                <span>{{user.email}}</span>
                            </div>
                        </div>
                    </p-tabpanel>
                </p-tabpanels>
            </p-tabs>
        </div>
        <div class="">
            <p-button icon="pi pi-cross" (onClick)="deactivateAccount()" label="Delete Account" variant="outlined" severity="danger"></p-button>
        </div>
    </div>
</div>

<ng-template #loader>
    <div style="display: flex; flex-direction: row; justify-content: center; width: 100%; height: 100%;">
        <p-progress-spinner ariaLabel="loading" />
    </div>
</ng-template>